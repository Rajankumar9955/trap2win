(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[863],{4796:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/upload",function(){return n(3430)}])},3430:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b}});var r=n(5893);n(5221);var a=n(765),i=n(6426),o=n(8995),s=n(5585),l=n(2920),c=n(7066);n(1664);var d=n(9008),u=n.n(d);n(9755);var f=n(7294),p=n(1163),h=n.n(p),v=n(662),m=n(381),y=n.n(m),j=n(3461);function b(){var e;let[t,n]=(0,f.useState)(),[d,p]=(0,f.useState)([]),[m,b]=(0,f.useState)(!1),[x,g]=(0,f.useState)(!0),[w,k]=(0,f.useState)(!1),[N,_]=(0,f.useState)([]),[O,C]=(0,f.useState)([]),[S,A]=(0,f.useState)(!1),[F,E]=(0,f.useState)([]),[D,U]=(0,f.useState)([]);function P(){let e={headers:{authorization:sessionStorage.getItem("ANATOKEN")}};c.Z.post("https://api.trap2win.com/admin/fetch-upload-record",{role:sessionStorage.getItem("ANAROLE"),user:sessionStorage.getItem("ANAID")},e).then(e=>{var t,n,r;(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.status)==="success"&&(C(null==e?void 0:null===(n=e.data)||void 0===n?void 0:n.correct),_(null==e?void 0:null===(r=e.data)||void 0===r?void 0:r.fake),console.log(null==e?void 0:e.data))},e=>{401==e.response.status&&(h().push("/"),R("Unauthorized access"))})}function I(e,t){let n={headers:{authorization:sessionStorage.getItem("ANATOKEN")}};c.Z.post("https://api.trap2win.com/admin/fetch-upload-date",{role:sessionStorage.getItem("ANAROLE"),user:sessionStorage.getItem("ANAID"),correct:e,start_date:t,end_date:t},n).then(e=>{var t;if((null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.status)==="success"){E(null==e?void 0:null===(n=e.data)||void 0===n?void 0:n.result),A(!0);var n,r=[];r.push(["Uploaded Date","Date","Order Id"]);for(let t=0;t<e.data.result.length;t++)r.push([y()(y()(e.data.result[t].createdAt)).format("ddd DD-MMM-YYYY"),y()(y()(e.data.result[t].date)).format("ddd DD-MMM-YYYY"),e.data.result[t].order_id]);U(r)}},e=>{401==e.response.status&&(h().push("/"),R("Unauthorized access"))})}(0,f.useEffect)(()=>{P()},[]);let M=e=>{let t=e.slice(0,e.indexOf("\n")).split(","),n=t.map(e=>e.replace(/"/g,"")),r=e.slice(e.indexOf("\n")+1).split("\n"),a=r.map(e=>{let t=e.split(","),r=n.reduce((e,n,r)=>(e[n]=t[r],e),{});return r});p(a)},T=e=>{if(e.preventDefault(),t){let e=new FileReader;e.onload=function(e){let t=e.target.result;M(t)},e.readAsText(t),g(!1),k(!0)}};function R(e){l.Am.error(e,{position:"bottom-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(u(),{children:[(0,r.jsx)("title",{children:"Upload"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"}),(0,r.jsx)("meta",{charSet:"UTF-8"}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"}),(0,r.jsx)("meta",{name:"msapplication-square70x70logo",content:"images/icon70.png"}),(0,r.jsx)("meta",{name:"msapplication-square150x150logo",content:"images/icon150.png"}),(0,r.jsx)("meta",{name:"msapplication-square310x310logo",content:"images/icon310.png"}),(0,r.jsx)("meta",{charSet:"utf-8"}),(0,r.jsx)("meta",{httpEquiv:"X-UA-Compatible",content:"IE=edge"}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1, shrink-to-fit=no"}),(0,r.jsx)("meta",{name:"description",content:""}),(0,r.jsx)("meta",{name:"author",content:""}),(0,r.jsx)("link",{href:"https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i",rel:"stylesheet"})]}),(0,r.jsxs)("div",{className:"page-top",children:[(0,r.jsxs)("div",{id:"wrapper",children:[(0,r.jsx)(i.Z,{}),(0,r.jsxs)("div",{id:"content-wrapper",className:"d-flex flex-column",children:[(0,r.jsxs)("div",{id:"content",children:[(0,r.jsx)(o.Z,{}),(0,r.jsxs)("div",{className:"container-fluid mb-5",children:[(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("div",{className:"card-header",children:(0,r.jsx)("div",{className:"row m-3",children:(0,r.jsx)("div",{className:"col-3",children:(0,r.jsx)("button",{className:"btn btn-primary btn-block",onClick:()=>b(!0),children:"Upload Data"})})})}),(0,r.jsx)("div",{className:"card-body",children:(0,r.jsxs)("div",{className:"row",children:[(0,r.jsx)("div",{className:"col-6",children:(0,r.jsxs)("table",{id:"tableUser",className:"table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"thead-light",children:[(0,r.jsx)("th",{children:"Uploaded Date"}),(0,r.jsx)("th",{children:"Correct"}),(0,r.jsx)("th",{})]})}),(0,r.jsx)("tbody",{children:(null==O?void 0:O.length)==0?(0,r.jsx)("tr",{children:(0,r.jsxs)("td",{colSpan:"5",className:"text-center",children:[" ","No record found"]})}):null==O?void 0:O.map((e,t)=>{let{_id:n,count:a}=e;return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:null==n?void 0:n.date}),(0,r.jsx)("td",{children:a}),(0,r.jsx)("td",{children:(0,r.jsx)("button",{className:"btn btn-outline-primary",onClick:()=>I(1,null==n?void 0:n.date1),children:(0,r.jsx)("i",{className:"fas fa-fw fa-eye"})})})]},null==n?void 0:n.date)})})]})}),(0,r.jsx)("div",{className:"col-6",children:(0,r.jsxs)("table",{id:"tableUser",className:"table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"thead-light",children:[(0,r.jsx)("th",{children:"Uploaded Date"}),(0,r.jsx)("th",{children:"Fake"}),(0,r.jsx)("th",{})]})}),(0,r.jsx)("tbody",{children:(null==N?void 0:N.length)==0?(0,r.jsx)("tr",{children:(0,r.jsxs)("td",{colSpan:"5",className:"text-center",children:[" ","No record found"]})}):null==N?void 0:N.map((e,t)=>{let{_id:n,count:a}=e;return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:null==n?void 0:n.date}),(0,r.jsx)("td",{children:a}),(0,r.jsx)("td",{children:(0,r.jsx)("button",{className:"btn btn-outline-primary",onClick:()=>I(0,null==n?void 0:n.date1),children:(0,r.jsx)("i",{className:"fas fa-fw fa-eye"})})})]},null==n?void 0:n.date)})})]})})]})})]}),(0,r.jsxs)(v.Z,{show:S,onHide:e=>{A(!1)},children:[(0,r.jsx)(v.Z.Header,{closeButton:!0,children:(0,r.jsx)(v.Z.Title,{children:"Uploaded Data"})}),(0,r.jsx)(v.Z.Body,{children:(0,r.jsxs)("div",{className:"container",children:[(0,r.jsxs)(j.CSVLink,{data:D,className:"btn btn-primary btn-block mb-3",filename:"trap2win-export-"+y()(y()(null===(e=F[0])||void 0===e?void 0:e.createdAt)).format("ddd DD-MMM-YYYY"),children:[(0,r.jsx)("i",{className:"fas fa-download"})," Export Data"]}),(0,r.jsxs)("table",{id:"tableUser",className:"table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"thead-light",children:[(0,r.jsx)("th",{children:"Date"}),(0,r.jsx)("th",{children:"Order Id"})]})}),(0,r.jsx)("tbody",{children:null==F?void 0:F.map((e,t)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:y()(y()(null==e?void 0:e.date)).format("ddd DD-MMM-YYYY")}),(0,r.jsx)("td",{children:null==e?void 0:e.order_id})]},t))})]})]})})]}),(0,r.jsxs)(v.Z,{show:m,onHide:e=>{g(!0),k(!1),b(!1)},children:[(0,r.jsx)(v.Z.Header,{closeButton:!0,children:(0,r.jsx)(v.Z.Title,{children:"Upload Data"})}),(0,r.jsx)(v.Z.Body,{children:(0,r.jsx)("div",{className:"container card my-3",children:(0,r.jsx)("form",{className:"m-3",children:(0,r.jsxs)("div",{className:"row",children:[(0,r.jsx)("div",{className:"col-8",children:(0,r.jsx)("input",{type:"file",id:"csvFileInput",accept:".csv",onChange:e=>{n(e.target.files[0])},className:"card-header"})}),(0,r.jsx)("div",{className:"col-4 my-2",children:(0,r.jsx)("button",{onClick:e=>{T(e)},type:"button",className:"btn btn-primary btn-block",disabled:w,children:"Add Data"})}),(0,r.jsx)("div",{children:(0,r.jsx)("small",{children:"*File format is .csv only"})}),(0,r.jsx)("div",{className:"col-12 my-2",children:(0,r.jsx)("button",{className:"btn btn-primary btn-block",disabled:x,onClick:e=>(function(e){e.preventDefault();let t={headers:{authorization:sessionStorage.getItem("ANATOKEN")}};g(!0),k(!0);for(var n,r,a,i=0;i<(null==d?void 0:d.length);i++)(null===(n=d[i])||void 0===n?void 0:n.order_id)&&c.Z.post("https://api.trap2win.com/admin/create-upload",{user:sessionStorage.getItem("ANAID"),order_id:null===(r=d[i])||void 0===r?void 0:r.order_id,date:new Date(null===(a=d[i])||void 0===a?void 0:a.date.split("-").reverse().join("-"))},t).then(e=>{if("error"===e.data.status){var t;R(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.message)}console.log(e)},e=>{401==e.response.status&&(h().push("/"),R("Unauthorized access"))}),i+1===d.length&&(g(!0),k(!1),b(!1),P());P()})(e),children:"Upload Data"})})]})})})})]})]})]}),(0,r.jsx)(s.Z,{})]})]}),(0,r.jsx)(a.Z,{})]})]})}},3461:function(e,t,n){e.exports=n(5090)},9469:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(r=n(7294))&&r.__esModule?r:{default:r},o=n(9182),s=n(9695),l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&("object"==typeof t||"function"==typeof t)?t:e}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"buildURI",value:function(){return o.buildURI.apply(void 0,arguments)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.data,n=e.headers,r=e.separator,a=e.enclosingCharacter,i=e.uFEFF,o=e.target,s=e.specs,l=e.replace;this.state.page=window.open(this.buildURI(t,i,n,r,a),o,s,l)}},{key:"getWindow",value:function(){return this.state.page}},{key:"render",value:function(){return null}}]),t}(i.default.Component);l.defaultProps=Object.assign(s.defaultProps,{target:"_blank"}),l.propTypes=s.propTypes,t.default=l},6425:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=(r=n(7294))&&r.__esModule?r:{default:r},s=n(9182),l=n(9695),c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&("object"==typeof t||"function"==typeof t)?t:e}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.buildURI=n.buildURI.bind(n),n}return!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"buildURI",value:function(){return s.buildURI.apply(void 0,arguments)}},{key:"handleLegacy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(window.navigator.msSaveOrOpenBlob){e.preventDefault();var n=this.props,r=n.data,a=n.headers,i=n.separator,o=n.filename,l=n.enclosingCharacter,c=n.uFEFF,d=t&&"function"==typeof r?r():r,u=new Blob([c?"\uFEFF":"",(0,s.toCSV)(d,a,i,l)]);return window.navigator.msSaveBlob(u,o),!1}}},{key:"handleAsyncClick",value:function(e){var t=this;this.props.onClick(e,function(n){if(!1===n){e.preventDefault();return}t.handleLegacy(e,!0)})}},{key:"handleSyncClick",value:function(e){if(!1===this.props.onClick(e)){e.preventDefault();return}this.handleLegacy(e)}},{key:"handleClick",value:function(){var e=this;return function(t){if("function"==typeof e.props.onClick)return e.props.asyncOnClick?e.handleAsyncClick(t):e.handleSyncClick(t);e.handleLegacy(t)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.data,r=t.headers,i=t.separator,s=t.filename,l=t.uFEFF,c=t.children,d=(t.onClick,t.asyncOnClick,t.enclosingCharacter),u=function(e,t){var n={};for(var r in e)!(t.indexOf(r)>=0)&&Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(t,["data","headers","separator","filename","uFEFF","children","onClick","asyncOnClick","enclosingCharacter"]),f="undefined"==typeof window?"":this.buildURI(n,l,r,i,d);return o.default.createElement("a",a({download:s},u,{ref:function(t){return e.link=t},target:"_self",href:f,onClick:this.handleClick()}),c)}}]),t}(o.default.Component);c.defaultProps=l.defaultProps,c.propTypes=l.propTypes,t.default=c},9182:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function r(e){if(!Array.isArray(e))return Array.from(e);for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}var a=t.isSafari=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},i=t.isJsons=function(e){return Array.isArray(e)&&e.every(function(e){return(void 0===e?"undefined":n(e))==="object"&&!(e instanceof Array)})},o=t.isArrays=function(e){return Array.isArray(e)&&e.every(function(e){return Array.isArray(e)})},s=t.jsonsHeaders=function(e){return Array.from(e.map(function(e){return Object.keys(e)}).reduce(function(e,t){return new Set([].concat(r(e),r(t)))},[]))},l=t.jsons2arrays=function(e,t){var n=t=t||s(e),a=t;return i(t)&&(n=t.map(function(e){return e.label}),a=t.map(function(e){return e.key})),[n].concat(r(e.map(function(e){return a.map(function(t){return c(t,e)})})))},c=t.getHeaderValue=function(e,t){var n=e.replace(/\[([^\]]+)]/g,".$1").split(".").reduce(function(e,t,n,r){var a=e[t];if(null!=a)return a;r.splice(1)},t);return void 0===n?e in t?t[e]:"":n},d=t.elementOrEmpty=function(e){return null==e?"":e},u=t.joiner=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:'"';return e.filter(function(e){return e}).map(function(e){return e.map(function(e){return d(e)}).map(function(e){return""+n+e+n}).join(t)}).join("\n")},f=t.arrays2csv=function(e,t,n,a){return u(t?[t].concat(r(e)):e,n,a)},p=t.jsons2csv=function(e,t,n,r){return u(l(e,t),n,r)},h=t.string2csv=function(e,t,n,r){return t?t.join(n)+"\n"+e:e.replace(/"/g,'""')},v=t.toCSV=function(e,t,n,r){if(i(e))return p(e,t,n,r);if(o(e))return f(e,t,n,r);if("string"==typeof e)return h(e,t,n);throw TypeError('Data should be a "String", "Array of arrays" OR "Array of objects" ')};t.buildURI=function(e,t,n,r,i){var o=v(e,n,r,i),s=a()?"application/csv":"text/csv",l=new Blob([t?"\uFEFF":"",o],{type:s}),c="data:"+s+";charset=utf-8,"+(t?"\uFEFF":"")+o,d=window.URL||window.webkitURL;return void 0===d.createObjectURL?c:d.createObjectURL(l)}},5090:function(e,t,n){"use strict";t.CSVLink=void 0;var r=i(n(9469)),a=i(n(6425));function i(e){return e&&e.__esModule?e:{default:e}}r.default,t.CSVLink=a.default},9695:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PropsNotForwarded=t.defaultProps=t.propTypes=void 0,(r=n(7294))&&r.__esModule;var r,a=n(5697);t.propTypes={data:(0,a.oneOfType)([a.string,a.array,a.func]).isRequired,headers:a.array,target:a.string,separator:a.string,filename:a.string,uFEFF:a.bool,onClick:a.func,asyncOnClick:a.bool,enclosingCharacter:a.string},t.defaultProps={separator:",",filename:"generatedBy_react-csv.csv",uFEFF:!0,asyncOnClick:!1,enclosingCharacter:'"'},t.PropsNotForwarded=["data","headers"]}},function(e){e.O(0,[571,885,437,66,662,370,774,888,179],function(){return e(e.s=4796)}),_N_E=e.O()}]);